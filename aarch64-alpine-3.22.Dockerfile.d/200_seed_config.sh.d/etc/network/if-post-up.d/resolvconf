#!/bin/sh
[ -n "$VERBOSE" ] && set -x

case "$PHASE" in
  post-up )
    [ -n "$IF_DNS_DOMAIN" ] && conf="${conf}domain $IF_DNS_DOMAIN\n"
    [ -n "$IF_DNS_SEARCH" ] && conf="${conf}search $IF_DNS_SEARCH\n"
    [ -n "$IF_DNS_SORTLIST" ] && conf="${conf}sortlist $IF_DNS_SORTLIST\n"
    [ -n "$IF_DNS_OPTIONS" ] && conf="${conf}options $IF_DNS_OPTIONS\n"
    for nameserver in $IF_DNS_NAMESERVERS; do
      conf="${conf}nameserver $nameserver\n"
    done
    if [ -n "$conf" ]; then
      conf="# Generated by ifup for $IFACE\n$conf"
      printf "$conf" | resolvconf -a "$IFACE"
    fi
    ;;
  post-down )
    resolvconf -f -d "$IFACE"
    ;;
esac
